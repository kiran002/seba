@(hasLoggedIn:Boolean,Listing:utils.Listing)
<!DOCTYPE html>
<html>
@head(Listing.listing.Name + " -- Listing details")
<body>
	@navbar(hasLoggedIn)
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-11 col-md-offset-1">
				@if(Listing.listing.ListingType=='O') {
				<h3>Showing Offer details for @Listing.listing.Name</h3>
				} else {
				<h3>Showing Request details for @Listing.listing.Name</h3>
				}
			</div>
			<hr />
		</div>
		<div class="row">
			<div class="col-md-10 col-md-offset-2">
				<div class="row">
					<div class="col-md-1">
						@if(Listing.path!="") {
						<div class="media-left">
							<img width="300" height="200" class="media-object thumbnail"
								src="assets/uploaded/@Listing.path" alt="Image">
						</div>
						} else {
						<div class="media-left">
							<img width="300" height="400" class="media-object thumbnail"
								src="assets/images/request.png" alt="Image">
						</div>
						}
					</div>
					<div class="col-md-9 col-md-offset-2">
						<div class="row">
							<div class="col-md-12">
								@if(Listing.isOwner) { <a
									href="/edit_listing?lid=@Listing.listing.ListingId">Edit </a> <a
									href="/delete_listing?lid=@Listing.listing.ListingId"
									onclick="return confirm('Are you sure??')">Delete</a> }
								<p>Article name: @Listing.listing.Name</p>
								<p>Category: @Listing.categoryName</p>
								@if(Listing.listing.ListingType=='R') {
								<p>Willing to pay</p>
								} @if(Listing.listing.TransactionType=='B') {
								<p>Looking to Buy for</p>
								<p>Price: @Listing.listing.Price</p>
								} @if(Listing.listing.TransactionType=='R'){
								<p>Looking to Rent for</p>
								<p>Price: @Listing.listing.Price /
									@Listing.listing.PricePeriod</p>
								} @if(Listing.listing.TransactionType=='S') {
								<p>Looking to sell for</p>
								<p>Price: @Listing.listing.Price</p>
								} @if(Listing.listing.PriceNegotiable) {
								<p>Price is negotiable</p>
								</p>
								}
								<p>Description:</p>
								<p>@Listing.listing.Description</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-11 col-md-offset-1">
				<h3>Messages</h3>
				@if(Listing.isOwner) { @if(Listing.msg_map.size > 0) {
				@for((key,value) <- (Listing.msg_map)) { <a class="btn btn-primary"
					role="button" data-toggle="collapse" href="#conv@key.FirstName"
					aria-expanded="false" aria-controls="conv@key.FirstName"><p>From
						user @key.FirstName</p></a>
				<div class="collapse" id="conv@key.FirstName">
					<br> @for(index <- 0 to (value.size-1)) {
					<div class="row">
						<div class="col-md-8 col-md-offset-1">
							<div class="panel panel-default">
								<div class="panel-heading">
									<h3 class="panel-title">
										@value(index).usrname said
										<div class="pull-right">on @value(index).date</div>
									</h3>
								</div>
								<div class="panel-body">@value(index).Message</div>
							</div>
						</div>
					</div>
					}
					<div class="row">
						<div class="col-md-8 col-md-offset-1">
							<form action="/post_message" method="post">
								<div class="form-group">
									<input type="hidden" name="ListingId"
										value="@Listing.listing.ListingId" /> <input type="hidden"
										name="ToUserId" value="@key.UserId" /> <label>Message:</label>
									<textarea class="form-control" rows="10" cols="10"
										name="Message"></textarea>
									<input type="submit" class="btn btn-default"
										value="Send message" />
								</div>
							</form>
						</div>
					</div>
				</div>
				} }else {
				<p>You have not received any messages</p>
				} } @if(!Listing.isOwner) { @if(Listing.messages.size > 0) {
				@for(index <- 0 to (Listing.messages.size-1)) {
				<div>
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title">
								@Listing.messages(index).usrname said
								<div class="pull-right">on @Listing.messages(index).date</div>
							</h3>
						</div>
						<div class="panel-body">@Listing.messages(index).Message</div>
					</div>
				</div>
				} }else {
				<p>You have not responded to this</p>
				}
				<form action="/post_message" method="post">
					<div class="form-group">
						<input type="hidden" name="ListingId"
							value="@Listing.listing.ListingId" /> <input type="hidden"
							name="ToUserId" value="@Listing.listing.UserId" /> <label>Message:</label>
						<textarea class="form-control" rows="10" cols="10" name="Message"></textarea>
						<input type="submit" class="btn btn-default" value="Send message" />
					</div>
				</form>
				}

			</div>
			<hr />
		</div>

	</div>
</body>
</html>